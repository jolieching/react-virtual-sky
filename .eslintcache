[{"/home/ignacy/react/virtual-sky/src/index.js":"1","/home/ignacy/react/virtual-sky/src/VirtualSky/projections.js":"2","/home/ignacy/react/virtual-sky/src/VirtualSky/projectionsConfig.js":"3","/home/ignacy/react/virtual-sky/src/VirtualSky/VirtualSky.js":"4","/home/ignacy/react/virtual-sky/src/VirtualSky/stars.js":"5","/home/ignacy/react/virtual-sky/src/VirtualSky/grids.js":"6","/home/ignacy/react/virtual-sky/src/VirtualSky/planets.js":"7","/home/ignacy/react/virtual-sky/src/stories/Sky.stories.js":"8","/home/ignacy/react/virtual-sky/src/VirtualSky/sunAndMoon.js":"9","/home/ignacy/react/virtual-sky/src/VirtualSky/galaxy.js":"10","/home/ignacy/react/virtual-sky/src/VirtualSky/constellationLines.js":"11","/home/ignacy/react/virtual-sky/src/VirtualSky/constllationBoundaries.js":"12","/home/ignacy/react/virtual-sky/src/VirtualSky/constellationLabels.js":"13","/home/ignacy/react/virtual-sky/src/VirtualSky/info.js":"14"},{"size":81,"mtime":1607902034853,"results":"15","hashOfConfig":"16"},{"size":7286,"mtime":1608592074341,"results":"17","hashOfConfig":"16"},{"size":1660,"mtime":1608592882133,"results":"18","hashOfConfig":"16"},{"size":4025,"mtime":1608592686843,"results":"19","hashOfConfig":"16"},{"size":77638,"mtime":1608592074341,"results":"20","hashOfConfig":"16"},{"size":1170,"mtime":1608592074337,"results":"21","hashOfConfig":"16"},{"size":16116,"mtime":1608593052878,"results":"22","hashOfConfig":"16"},{"size":2468,"mtime":1608598573885,"results":"23","hashOfConfig":"16"},{"size":3282,"mtime":1608592074341,"results":"24","hashOfConfig":"16"},{"size":12184,"mtime":1608593092684,"results":"25","hashOfConfig":"16"},{"size":12660,"mtime":1608592074337,"results":"26","hashOfConfig":"16"},{"size":19898,"mtime":1608592074337,"results":"27","hashOfConfig":"16"},{"size":1178,"mtime":1608592074337,"results":"28","hashOfConfig":"16"},{"size":692,"mtime":1608593006154,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"34glj7",{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"38"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"41","usedDeprecatedRules":"35"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"48","usedDeprecatedRules":"35"},{"filePath":"49","messages":"50","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},"/home/ignacy/react/virtual-sky/src/index.js",[],["63","64"],"/home/ignacy/react/virtual-sky/src/VirtualSky/projections.js",[],["65","66"],"/home/ignacy/react/virtual-sky/src/VirtualSky/projectionsConfig.js",[],["67","68"],"/home/ignacy/react/virtual-sky/src/VirtualSky/VirtualSky.js",["69"],"import React, {useState, useEffect, useRef, useLayoutEffect} from 'react';\nimport d3 from 'd3'\nimport projectionsConfig from '../VirtualSky/projectionsConfig.js';\nimport {calcConstellationLines, drawConstellationLines} from './constellationLines.js';\nimport {calcConstellationLabels, drawConstellationLabels} from './constellationLabels.js';\nimport {calcBoundaries, drawBoundaries} from './constllationBoundaries.js';\nimport {calcGalaxy, drawGalaxy} from './galaxy.js';\nimport {calcGrids, drawGridAz} from './grids.js';\nimport {drawStars} from './stars.js';\nimport {drawMoonAndSun} from './sunAndMoon.js';\nimport {calcPlanets, drawPlanets, drawPlanetOrbits, drawPlanetLabels} from './planets.js';\nimport {drawInfo} from './info.js';\nimport {stereo} from './projections.js'\n\nlet  clickAz = null;\nlet stars = [];\nlet planets = [];\nlet svg = null;\nlet azOff = 0;\n\nconst VirtualSky = (props) => {\n  azOff = (props.config.azOff%360)-180;\n\n  const r2d = 180.0/Math.PI;\n  const targetRef = useRef();\n  const time = props.config.time || new Date()\n  const visibility = props.config.visibility;\n  const starMag = visibility.starMag || 2;\n  const config = projectionsConfig(props.config.width, props.config.height, props.config.latitude, props.config.longitude, time)\n\n\n  useLayoutEffect(() => {\n    if (targetRef.current) {\n      config.width = config.width || targetRef.current.offsetWidth;\n      config.height = config.height || targetRef.current.offsetHeight;\n    }\n  }, [config]);\n\n  useEffect(() => {\n    svg = drawCanvas();\n    draw(svg, azOff, stars);\n  });\n\n  const draw = (svg, azOff, stars) =>{\n      const start = new Date().getTime();\n      if(visibility.showGalaxy){\n        calcGalaxy(stereo, azOff, config);\n        drawGalaxy(svg);\n      }\n      if(visibility.showAzGrid){\n        calcGrids(stereo, azOff, config);\n        drawGridAz(svg);\n      }\n      if(visibility.showConstellations){\n        calcConstellationLines(stereo, azOff, config);\n        drawConstellationLines(svg, config);\n      }\n      if(visibility.showConstellationBoundaries){\n        calcBoundaries(stereo, azOff, config);\n        drawBoundaries(svg, config);\n      }\n      drawStars(svg, stereo, azOff, config, starMag);\n      if(visibility.showPlanets || visibility.showPlanetsLabels || visibility.showPlanetsOrbit){\n        calcPlanets(stereo, azOff, config);\n        if(visibility.showPlanets) drawPlanets(svg);\n        if(visibility.showPlanetsLabels) drawPlanetLabels(svg);\n        if(visibility.showPlanetsOrbit) drawPlanetOrbits(svg);\n      }\n      if(visibility.showSunMoon){\n        drawMoonAndSun(svg, stereo, azOff, config);\n      }\n      if(visibility.showConstellationLabels){\n        calcConstellationLabels(stereo, azOff, config);\n        drawConstellationLabels(svg);\n      }\n      const rendTime = new Date().getTime() - start + \"ms\";\n      drawInfo(svg, config, rendTime);\n  }\n\n  const drawCanvas = () =>{\n    d3.select(\"#\" + props.id).select(\"svg\").remove();\n    const svg = d3.select(\"#\" + props.id).append(\"svg\")\n        .attr(\"width\", config.width)\n        .attr(\"height\", config.height)\n        .style(\"background\", \"black\")\n       .on('mousedown', (d) =>{\n         const pos = stereo.xy2azel(...d3.mouse(svg.node()), config.width, config.height);\n         clickAz = pos.az;\n       })\n       .on('mousemove', (d)=>{\n         if(clickAz){\n           const pos = stereo.xy2azel(...d3.mouse(svg.node()), config.width, config.height);\n           const newAzOff = azOff + (clickAz - pos.az )*r2d;\n           draw(svg, newAzOff, stars, planets)\n         }\n       })\n       .on('mouseup',(d) =>{\n         const pos = stereo.xy2azel(...d3.mouse(svg.node()), config.width, config.height);\n         azOff = azOff + (clickAz - pos.az )*r2d;\n         clickAz = null;\n         draw(svg, azOff, stars, planets)\n       })\n   return svg;\n  }\n\n  return (\n    <div ref={targetRef} style={{bottom: \"0px\", top: \"0px\", right: \"0px\", left: \"0px\", position: \"absolute\"}}>\n      <div id={props.id}/>\n    </div>\n  );\n};\n\nexport default VirtualSky;\n","/home/ignacy/react/virtual-sky/src/VirtualSky/stars.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/grids.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/planets.js",["70","71","72"],"import {interpolate} from './projections.js';\nimport {radec2xy} from './projections.js';\nimport d3 from 'd3'\n\nconst d2r = Math.PI/180;\nconst r2d = 180.0/Math.PI;\nconst AUinkm = 149597870.700;\n\nlet planets = [];\n\nexport const calcPlanets = (projection, azOff, config) =>{\n\tconst days = 365.25;\n  const jd = config.astronomicalTimes.JD;\n\tconst planetsBuilded = build(Math.floor(jd)-days*0.25,days*1.25);\n  planets = [];\n\n  planetsBuilded.forEach((p, i) => {\n    if(p[2].length%4 === 0){\n      if(jd > p[2][0] && jd < p[2][(p[2].length-4)]){\n        const interp = interpolate(jd,p[2]);\n        const planet = {\n          name: p[0],\n          orbit: [],\n          ra: interp.ra,\n          dev: interp.dec,\n          mag: interp.mag,\n          color: p[1],\n          ...radec2xy(interp.ra*d2r, interp.dec*d2r, projection, azOff, config)\n        }\n        planets.push(planet);\n        let o = 0;\n        planet.orbit[o] = []\n  \t\t\tfor(let i = 0 ; i < p[2].length-4 ; i+=4){\n          const point = radec2xy(p[2][i+1]*d2r, p[2][i+2]*d2r, projection, azOff, config)\n          if(typeof point === \"object\"){\n            planet.orbit[o].push(point);\n          }else{\n            planet.orbit[++o] = [];\n          }\n        }\n      }\n    }\n  });\n}\n\nexport const drawPlanets = (svg) =>{\n  const pp = planets.filter(s=>(isVisible(s.el) && !isNaN(s.x) && !isPointBad(s)));\n\n  const circles = svg.selectAll('.planet');\n  const databoundCircles = circles.data(pp);\n  databoundCircles.enter().append('circle').attr('class','planet');;\n  databoundCircles.exit().remove();\n  databoundCircles\n      .attr(\"cx\", (d) =>{ return d.x; })\n      .attr(\"cy\", (d) =>{ return d.y; })\n      .attr(\"r\", (d) =>{ return d.mag ? (9-d.mag) : 0; })\n      .style(\"fill\", (d) =>{ return d.color; });\n}\n\nexport const drawPlanetOrbits = (svg) =>{\n  planets.forEach((planet, i) => {\n    planet.orbit = planet.orbit.filter(o=>o.length>0);\n  });\n\n  planets.forEach((planet, i) => {\n    const orbits = svg.selectAll('.planetOrbit' + planet.name);\n    const databoundOrbits = orbits.data(planet.orbit);\n    databoundOrbits.enter().append('path').attr('class','planetOrbit' + planet.name);;\n    databoundOrbits.exit().remove();\n    databoundOrbits\n        .attr(\"d\", (d)=>lineFunction(d))\n        .attr(\"stroke\", planet.color)\n        .attr(\"stroke-width\", 1)\n        .attr(\"fill\", \"none\");\n  });\n}\n\nexport const drawPlanetLabels = (svg) =>{\n    const labels = svg.selectAll('.planetLabels');\n    const databoundLabels = labels.data(planets);\n    databoundLabels.enter().append('text').attr('class','planetLabels');;\n    databoundLabels.exit().remove();\n    databoundLabels\n      .attr(\"x\", (d) =>{ return d.x; })\n      .attr(\"y\", (d) =>{ return d.y; })\n      .attr(\"dx\", (d) =>{ return 5; })\n      .attr(\"fill\", (d) =>{ return d.color; })\n      .attr(\"font-size\", \".7em\")\n      .attr(\"font-family\", \"Arial\")\n      .text( (d) =>{ return d.name; });\n}\n\n\nconst lineFunction = d3.svg.line()\n  .x(d =>{ return d.x; })\n  .y(d =>{ return d.y; })\n  .interpolate(\"linear\");\n\nconst isVisible = (el) =>{\n\treturn el > 0;\n};\nconst isPointBad = (p) =>{\n\treturn p.x===-1 && p.y===-1;\n};\n\nconst planetsDefinitions2 = [{\n\t\"name\": \"Me\",\n\t\"radius\":2439.7,\t// km\n\t\"interval\": 0.5,\n\t\"colour\": \"rgb(170,150,170)\",\n\t\"magnitude\": function(d){ return -0.36 + 5*log10(d.r*d.R) + 0.027 * d.FV + 2.2E-13 * Math.pow(d.FV,6); },\n\t\"elements\": [\n\t\t{\"jd\":2456280.5,\"i\":7.0053,\"o\":48.485,\"p\":77.658,\"a\":0.387100,\"n\":4.09232,\"e\":0.205636,\"L\":191.7001},\n\t\t{\"jd\":2456360.5,\"i\":7.0052,\"o\":48.487,\"p\":77.663,\"a\":0.387098,\"n\":4.09235,\"e\":0.205646,\"L\":159.0899},\n\t\t{\"jd\":2456440.5,\"i\":7.0052,\"o\":48.490,\"p\":77.665,\"a\":0.387097,\"n\":4.09236,\"e\":0.205650,\"L\":126.4812},\n\t\t{\"jd\":2456520.5,\"i\":7.0052,\"o\":48.493,\"p\":77.669,\"a\":0.387098,\"n\":4.09235,\"e\":0.205645,\"L\":93.8725},\n\t\t{\"jd\":2456600.5,\"i\":7.0052,\"o\":48.495,\"p\":77.672,\"a\":0.387099,\"n\":4.09234,\"e\":0.205635,\"L\":61.2628},\n\t\t{\"jd\":2456680.5,\"i\":7.0052,\"o\":48.498,\"p\":77.677,\"a\":0.387098,\"n\":4.09234,\"e\":0.205633,\"L\":28.6524}\n\t]\n},{\n\t\"name\": \"V\",\n\t\"radius\": 6051.9,\t// km\n\t\"interval\": 1,\n\t\"colour\": \"rgb(245,222,179)\",\n\t\"magnitude\": function(d){ return -4.34 + 5*log10(d.a*d.R) + 0.013 * d.FV + 4.2E-7*Math.pow(d.FV,3); },\n\t\"elements\": [\n\t\t{\"jd\":2456280.5,\"i\":3.3949,\"o\":76.797,\"p\":132.00,\"a\":0.723328,\"n\":1.60214,\"e\":0.006777,\"L\":209.0515},\n\t\t{\"jd\":2456360.5,\"i\":3.3949,\"o\":76.799,\"p\":132.07,\"a\":0.723327,\"n\":1.60215,\"e\":0.006787,\"L\":337.2248},\n\t\t{\"jd\":2456440.5,\"i\":3.3949,\"o\":76.802,\"p\":131.97,\"a\":0.723333,\"n\":1.60213,\"e\":0.006780,\"L\":105.3980},\n\t\t{\"jd\":2456520.5,\"i\":3.3949,\"o\":76.804,\"p\":131.99,\"a\":0.723327,\"n\":1.60215,\"e\":0.006769,\"L\":233.5729},\n\t\t{\"jd\":2456600.5,\"i\":3.3949,\"o\":76.807,\"p\":132.03,\"a\":0.723326,\"n\":1.60215,\"e\":0.006775,\"L\":1.7475},\n\t\t{\"jd\":2456680.5,\"i\":3.3948,\"o\":76.808,\"p\":131.63,\"a\":0.723345,\"n\":1.60209,\"e\":0.006770,\"L\":129.9169}\n\t]\n},{\n\t\"name\":\"E\",\n\t\"elements\" : [\n\t\t{\"jd\":2450680.5,\"i\":0.00041,\"o\":349.2,\"p\":102.8517,\"a\":1.0000200,\"n\":0.9855796,\"e\":0.0166967,\"L\":328.40353},\n\t\t{\"jd\":2456320.5,\"i\":0.0,\"o\":349.2,\"p\":103.005,\"a\":0.999986,\"n\":0.985631,\"e\":0.016682,\"L\":127.4201},\n\t\t{\"jd\":2456400.5,\"i\":0.0,\"o\":349.2,\"p\":103.022,\"a\":0.999987,\"n\":0.985630,\"e\":0.016677,\"L\":206.2740},\n\t\t{\"jd\":2456480.5,\"i\":0.0,\"o\":349.2,\"p\":103.119,\"a\":1.000005,\"n\":0.985603,\"e\":0.016675,\"L\":285.1238},\n\t\t{\"jd\":2456560.5,\"i\":0.0,\"o\":349.2,\"p\":103.161,\"a\":0.999995,\"n\":0.985618,\"e\":0.016682,\"L\":3.9752},\n\t\t{\"jd\":2456680.5,\"i\":0.0,\"o\":349.2,\"p\":103.166,\"a\":1.000005,\"n\":0.985603,\"e\":0.016693,\"L\":122.2544}\n\t]\n},{\n\t\"name\":\"Ma\",\n\t\"radius\": 3386,\t// km\n\t\"interval\": 1,\n\t\"colour\": \"rgb(255,50,50)\",\n\t\"magnitude\": function(d){ return -1.51 + 5*log10(d.r*d.R) + 0.016 * d.FV; },\n\t\"elements\":[\n\t\t{\"jd\":2450680.5,\"i\":1.84992,\"o\":49.5664,\"p\":336.0882,\"a\":1.5236365,\"n\":0.5240613,\"e\":0.0934231,\"L\":262.42784},\n\t\t{\"jd\":2456320.5,\"i\":1.8497,\"o\":49.664,\"p\":336.249,\"a\":1.523605,\"n\":0.524079,\"e\":0.093274,\"L\":338.1493},\n\t\t{\"jd\":2456400.5,\"i\":1.8497,\"o\":49.666,\"p\":336.268,\"a\":1.523627,\"n\":0.524068,\"e\":0.093276,\"L\":20.0806},\n\t\t{\"jd\":2456480.5,\"i\":1.8496,\"o\":49.668,\"p\":336.306,\"a\":1.523731,\"n\":0.524014,\"e\":0.093316,\"L\":62.0048},\n\t\t{\"jd\":2456560.5,\"i\":1.8495,\"o\":49.666,\"p\":336.329,\"a\":1.523748,\"n\":0.524005,\"e\":0.093385,\"L\":103.9196},\n\t\t{\"jd\":2456680.5,\"i\":1.8495,\"o\":49.665,\"p\":336.330,\"a\":1.523631,\"n\":0.524066,\"e\":0.093482,\"L\":166.8051}\n\t]\n},{\n\t\"name\":\"J\",\n\t\"radius\": 69173,\t// km\n\t\"interval\": 10,\n\t\"colour\": \"rgb(255,150,150)\",\n\t\"magnitude\": function(d){ return -9.25 + 5*log10(d.r*d.R) + 0.014 * d.FV; },\n\t\"elements\":[\n\t\t{\"jd\":2456280.5,\"i\":1.3033,\"o\":100.624,\"p\":14.604,\"a\":5.20269,\"n\":0.083094,\"e\":0.048895,\"L\":68.0222},\n\t\t{\"jd\":2456360.5,\"i\":1.3033,\"o\":100.625,\"p\":14.588,\"a\":5.20262,\"n\":0.083095,\"e\":0.048895,\"L\":74.6719},\n\t\t{\"jd\":2456440.5,\"i\":1.3033,\"o\":100.627,\"p\":14.586,\"a\":5.20259,\"n\":0.083096,\"e\":0.048892,\"L\":81.3228},\n\t\t{\"jd\":2456520.5,\"i\":1.3033,\"o\":100.629,\"p\":14.556,\"a\":5.20245,\"n\":0.083099,\"e\":0.048892,\"L\":87.9728},\n\t\t{\"jd\":2456600.5,\"i\":1.3033,\"o\":100.631,\"p\":14.576,\"a\":5.20254,\"n\":0.083097,\"e\":0.048907,\"L\":94.6223},\n\t\t{\"jd\":2456680.5,\"i\":1.3033,\"o\":100.633,\"p\":14.592,\"a\":5.20259,\"n\":0.083096,\"e\":0.048891,\"L\":101.2751}\n\t]\n},{\n\t\"name\":\"S\",\n\t\"radius\": 57316,\t// km\n\t\"interval\": 10,\n\t\"colour\": \"rgb(200,150,150)\",\n\t\"magnitude\": function(d){\n\t\tvar slon = Math.atan2(d.y,d.x);\n\t\tvar slat = Math.atan2(d.z, Math.sqrt(d.x*d.x + d.y*d.y));\n\t\twhile(slon < 0){ slon += 2*Math.PI; }\n\t\twhile(slon >= 360){ slon -= 2*Math.PI; }\n\t\tvar ir = d.d2r*28.06;\n\t\tvar Nr = d.d2r*(169.51 + 3.82E-5 * (d.jd-2451543.5));\t// Compared to J2000 epoch\n\t\tvar B = Math.asin(Math.sin(slat) * Math.cos(ir) - Math.cos(slat) * Math.sin(ir) * Math.sin(slon-Nr));\n\t\treturn -9.0  + 5*log10(d.r*d.R) + 0.044 * d.FV + (-2.6 * Math.sin(Math.abs(B)) + 1.2 * Math.pow(Math.sin(B),2));\n\t},\n\t\"elements\":[\n\t\t{\"jd\":2456280.5,\"i\":2.4869,\"o\":113.732,\"p\":90.734,\"a\":9.51836,\"n\":0.033583,\"e\":0.055789,\"L\":208.6057},\n\t\t{\"jd\":2456360.5,\"i\":2.4869,\"o\":113.732,\"p\":90.979,\"a\":9.52024,\"n\":0.033574,\"e\":0.055794,\"L\":211.2797},\n\t\t{\"jd\":2456440.5,\"i\":2.4869,\"o\":113.732,\"p\":91.245,\"a\":9.52234,\"n\":0.033562,\"e\":0.055779,\"L\":213.9525},\n\t\t{\"jd\":2456520.5,\"i\":2.4869,\"o\":113.732,\"p\":91.500,\"a\":9.52450,\"n\":0.033551,\"e\":0.055724,\"L\":216.6279},\n\t\t{\"jd\":2456600.5,\"i\":2.4870,\"o\":113.732,\"p\":91.727,\"a\":9.52630,\"n\":0.033541,\"e\":0.055691,\"L\":219.3014},\n\t\t{\"jd\":2456680.5,\"i\":2.4870,\"o\":113.733,\"p\":92.021,\"a\":9.52885,\"n\":0.033528,\"e\":0.055600,\"L\":221.9730}\n\t]\n},{\n\t\"name\":\"U\",\n\t\"radius\": 25266,\t// km\n\t\"interval\": 20,\n\t\"colour\": \"rgb(130,150,255)\",\n\t\"magnitude\": function(d){ return -7.15 + 5*log10(d.r*d.R) + 0.001 * d.FV; },\n\t\"elements\":[\n\t\t{\"jd\":2456280.5,\"i\":0.7726,\"o\":74.004,\"p\":169.227,\"a\":19.2099,\"n\":0.011713,\"e\":0.046728,\"L\":9.1400},\n\t\t{\"jd\":2456360.5,\"i\":0.7727,\"o\":73.997,\"p\":169.314,\"a\":19.2030,\"n\":0.011720,\"e\":0.047102,\"L\":10.0873},\n\t\t{\"jd\":2456440.5,\"i\":0.7728,\"o\":73.989,\"p\":169.434,\"a\":19.1953,\"n\":0.011727,\"e\":0.047509,\"L\":11.0340},\n\t\t{\"jd\":2456520.5,\"i\":0.7728,\"o\":73.989,\"p\":169.602,\"a\":19.1882,\"n\":0.011733,\"e\":0.047874,\"L\":11.9756},\n\t\t{\"jd\":2456600.5,\"i\":0.7728,\"o\":73.985,\"p\":169.740,\"a\":19.1816,\"n\":0.011739,\"e\":0.048215,\"L\":12.9200},\n\t\t{\"jd\":2456680.5,\"i\":0.7728,\"o\":73.983,\"p\":169.962,\"a\":19.1729,\"n\":0.011747,\"e\":0.048650,\"L\":13.8617}\n\t]\n},{\n\t\"name\":\"N\",\n\t\"radius\": 24553,\t// km\n\t\"interval\": 20,\n\t\"colour\": \"rgb(100,100,255)\",\n\t\"magnitude\": function(d){ return -6.90 + 5*log10(d.r*d.R) + 0.001 * d.FV; },\n\t\"elements\":[\n\t\t{\"jd\":2456280.5,\"i\":1.7686,\"o\":131.930,\"p\":53.89,\"a\":30.0401,\"n\":0.005990,\"e\":0.010281,\"L\":333.6121},\n\t\t{\"jd\":2456360.5,\"i\":1.7688,\"o\":131.935,\"p\":56.47,\"a\":30.0259,\"n\":0.005994,\"e\":0.010138,\"L\":334.0856},\n\t\t{\"jd\":2456440.5,\"i\":1.7690,\"o\":131.940,\"p\":59.24,\"a\":30.0108,\"n\":0.005999,\"e\":0.009985,\"L\":334.5566},\n\t\t{\"jd\":2456520.5,\"i\":1.7692,\"o\":131.946,\"p\":61.52,\"a\":29.9987,\"n\":0.006002,\"e\":0.009816,\"L\":335.0233},\n\t\t{\"jd\":2456600.5,\"i\":1.7694,\"o\":131.951,\"p\":63.84,\"a\":29.9867,\"n\":0.006006,\"e\":0.009690,\"L\":335.4937},\n\t\t{\"jd\":2456680.5,\"i\":1.7697,\"o\":131.957,\"p\":66.66,\"a\":29.9725,\"n\":0.006010,\"e\":0.009508,\"L\":335.9564}\n\t]\n}];\n\n// Build an array containing all the planets\n// Inputs:\n//  jd = the Julian Date to calculate from\n//  days = the number of days to calculate ephemerides for\nconst build = (jd,days) =>{\n\tvar arr = new Array(planetsDefinitions2.length-1);\n\tvar b = 0;\n\tif(!days) days = 365.25;\n\tfor(var a = 0 ; a < planetsDefinitions2.length ; a++){\n\t\tif(planetsDefinitions2[a].colour) arr[b++] = buildPlanet(a,jd,days);\n\t}\n\treturn arr;\n}\n\n// Build the data array for a particular planet\n// Inputs:\n//  planet = the ID of the planet\n//  jd = the Julian Date to calculate from\n//  days = the number of days to calculate ephemerides for\nconst buildPlanet = (planet,jd,days) =>{\n\tvar p,coord,interval,n,jdcurr;\n\tif(typeof planet===\"number\"){\n\t\tp = planet;\n\t}else{\n\t\tvar match = -1;\n\t\tfor(var a = 0 ; a < planetsDefinitions2.length ; a++){\n\t\t\tif(planetsDefinitions2[a].name===planet) match = a;\n\t\t}\n\t\tif(match < 0) return this;\n\t\tif(match === 2) return this;\t// Can't calculate Earth\n\t\tp = match;\n\t}\n\n\tinterval = (typeof planetsDefinitions2[p].interval===\"number\" ? planetsDefinitions2[p].interval : 1);\n\n\t// Build an array of the form:\n\t// [Planet name,colour,[jd_1, ra_1, dec_1, mag_1, jd_2, ra_2, dec_2, mag_2....]]\n\tn = Math.floor(days/interval);\n\tvar arr = new Array(3);\n\tarr[0] = planetsDefinitions2[p][\"name\"];\n\tarr[1] = planetsDefinitions2[p][\"colour\"];\n\tarr[2] = new Array(n*4);\n\n\tjdcurr = jd;\n\tfor(var i = 0 ; i < n; i++){\n\t\tjdcurr += interval;\n\t\tcoord = getEphem(p,jdcurr);\n\t\tarr[2][i*4+0] = jdcurr;\n\t\tarr[2][i*4+1] = coord[0];\n\t\tarr[2][i*4+2] = coord[1];\n\t\tarr[2][i*4+3] = coord[2];\n\t}\n\treturn arr;\n}\n\n// Get the ephemeris for the specified planet number\n// Input:\n//   planet = ID\n//   day = Julian Date to calculate the ephemeris for\n// Method from http://www.stargazing.net/kepler/ellipse.html#twig06\nconst getEphem = (planet,day) =>{\n\n\tvar i,v,e,x,y,z,ec,q,ra,dc,R,mag,FV,phase;\n\n\tif(typeof planet===\"number\"){\n\t\ti = planet;\n\t}else{\n\t\tvar match = -1;\n\t\tfor(var a = 0 ; a < planetsDefinitions2.length ; a++){\n\t\t\tif(planetsDefinitions2[a].name===planet) match = a;\n\t\t}\n\t\tif(match < 0) return this;\n\t\tif(match === 2) return this;\t// Can't calculate Earth\n\t\ti = match;\n\t}\n\n\t// Heliocentric coordinates of planet\n\tv = getHeliocentric(planetsDefinitions2[i],day);\n\n\t// Heliocentric coordinates of Earth\n\te = getHeliocentric(planetsDefinitions2[2],day);\n\n\t// Geocentric ecliptic coordinates of the planet\n\tx = v.xyz[0] - e.xyz[0];\n\ty = v.xyz[1] - e.xyz[1];\n\tz = v.xyz[2] - e.xyz[2];\n\n\t// Geocentric equatorial coordinates of the planet\n\tec = 23.439292*d2r; // obliquity of the ecliptic for the epoch the elements are referred to\n\tq = [x,y * Math.cos(ec) - z * Math.sin(ec),y * Math.sin(ec) + z * Math.cos(ec)];\n\n\tra = Math.atan(q[1]/q[0])*r2d;\n\tif(q[0] < 0) ra += 180;\n\tif(q[0] >= 0 && q[1] < 0) ra += 360;\n\n\tdc = Math.atan(q[2] / Math.sqrt(q[0]*q[0] + q[1]*q[1]))*r2d;\n\n\tR = Math.sqrt(q[0]*q[0] + q[1]*q[1] + q[2]*q[2]);\n\n\t// Calculate the magnitude (http://stjarnhimlen.se/comp/tutorial.html)\n\tvar angdiam = (planetsDefinitions2[i].radius*2/(R*AUinkm));//TODO: calculate planets magnitude\n\tmag = 1;\n\n\t// planet's heliocentric distance, v.r, its geocentric distance, R, and the distance to the Sun, e.r.\n\tFV = Math.acos( ( v.r*v.r + R*R - e.r*e.r ) / (2*v.r*R) );\n\tphase = (1 + Math.cos(FV))/2;\n\tmag = planetsDefinitions2[i].magnitude({a:v.r,r:v.r,R:R,FV:FV*r2d,x:x,y:y,z:z,jd:day,d2r:d2r});\n\n\treturn [ra,dc,mag];\n}\n\nconst getHeliocentric = (planet,jd,i) =>{\n\tvar min = 1e10;\n\tvar mn,p,d,M,v,r;\n\n\t// Choose a set of orbital elements\n\tif(!i){\n\t\t// Loop over elements and pick the one closest in time\n\t\tfor(var j = 0; j < planet.elements.length ;j++){\n\t\t\tmn = Math.abs(planet.elements[j].jd-jd);\n\t\t\tif(mn < min){\n\t\t\t\ti = j;\n\t\t\t\tmin = mn;\n\t\t\t}\n\t\t}\n\t}\n\tp = planet.elements[i];\n\n\t// The day number is the number of days (decimal) since epoch of elements.\n\td = (jd - p.jd);\n\n\t// Heliocentric coordinates of planet\n\tM = meanAnomaly(p.n,d,p.L,p.p)\n\tv = trueAnomaly(M*d2r,p.e,10);\n\tr = p.a * (1 - Math.pow(p.e,2)) / (1 + p.e * Math.cos(v*d2r));\n\treturn {xyz: heliocentric(v*d2r,r,p.p*d2r,p.o*d2r,p.i*d2r), M:M, v:v, r:r, i:i, d:d, elements:p};\n}\n\n// Find the Mean Anomaly (M, degrees) of the planet where\n//  n is daily motion\n//  d is the number of days since the date of the elements\n//  L is the mean longitude (deg)\n//  p is the longitude of perihelion (deg)\n//  M should be in range 0 to 360 degrees\nconst meanAnomaly = function(d,n,L,p){\n\tvar M = n * d + L - p;\n\twhile(M < 0){ M += 360; }\n\twhile(M >= 360){ M -= 360; }\n\treturn M;\n}\n\n// Heliocentric coordinates of the planet where:\n//  o is longitude of ascending node (radians)\n//  p is longitude of perihelion (radians)\n//  i is inclination of plane of orbit (radians)\n// the quantity v + o - p is the angle of the planet measured in the plane of the orbit from the ascending node\nconst heliocentric = function(v,r,p,o,i){\n\tvar vpo = v + p - o;\n\tvar svpo = Math.sin(vpo);\n\tvar cvpo = Math.cos(vpo);\n\tvar co = Math.cos(o);\n\tvar so = Math.sin(o);\n\tvar ci = Math.cos(i);\n\tvar si = Math.sin(i);\n\treturn [r * (co * cvpo - so * svpo * ci),r * (so * cvpo + co * svpo * ci),r * (svpo * si)]\n}\n\n// Find the True Anomaly given\n// m  -  the 'mean anomaly' in orbit theory (in radians)\n// ecc - the eccentricity of the orbit\nconst trueAnomaly = function(m,ecc,eps){\n\tvar e = m;        // first guess\n\n\tif(typeof eps===\"number\"){\n\t\tvar delta = 0.05; // set delta equal to a dummy value\n\t\tvar eps = 10;     // eps - the precision parameter - solution will be within 10^-eps of the true value. Don't set eps above 14, as convergence can't be guaranteed\n\n\t\twhile(Math.abs(delta) >= Math.pow(10,-eps)){    // converged?\n\t\t\tdelta = e - ecc * Math.sin(e) - m;          // new error\n\t\t\te -= delta / (1 - ecc * Math.cos(e));    // corrected guess\n\t\t}\n\t\tvar v = 2 * Math.atan(Math.pow(((1 + ecc) / (1 - ecc)),0.5) * Math.tan(0.5 * e));\n\t\tif(v < 0) v+= Math.PI*2;\n\t}else{\n\t\tv = m + ( (2 * ecc - Math.pow(ecc,3)/4)*Math.sin(m) + 1.25*Math.pow(ecc,2)*Math.sin(2*m) + (13/12)*Math.pow(ecc,3)*Math.sin(3*m) );\n\t}\n\treturn v*r2d; // return estimate\n}\n\nconst log10 = (x) =>{\n\treturn Math.LOG10E * Math.log(x);\n}\n","/home/ignacy/react/virtual-sky/src/stories/Sky.stories.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/sunAndMoon.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/galaxy.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/constellationLines.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/constllationBoundaries.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/constellationLabels.js",[],"/home/ignacy/react/virtual-sky/src/VirtualSky/info.js",[],{"ruleId":"73","replacedBy":"74"},{"ruleId":"75","replacedBy":"76"},{"ruleId":"73","replacedBy":"77"},{"ruleId":"75","replacedBy":"78"},{"ruleId":"73","replacedBy":"79"},{"ruleId":"75","replacedBy":"80"},{"ruleId":"81","severity":1,"message":"82","line":1,"column":16,"nodeType":"83","messageId":"84","endLine":1,"endColumn":24},{"ruleId":"81","severity":1,"message":"85","line":325,"column":6,"nodeType":"83","messageId":"84","endLine":325,"endColumn":13},{"ruleId":"81","severity":1,"message":"86","line":330,"column":2,"nodeType":"83","messageId":"84","endLine":330,"endColumn":7},{"ruleId":"87","severity":1,"message":"88","line":400,"column":7,"nodeType":"83","messageId":"89","endLine":400,"endColumn":10},"no-native-reassign",["90"],"no-negated-in-lhs",["91"],["90"],["91"],["90"],["91"],"no-unused-vars","'useState' is defined but never used.","Identifier","unusedVar","'angdiam' is assigned a value but never used.","'phase' is assigned a value but never used.","no-redeclare","'eps' is already defined.","redeclared","no-global-assign","no-unsafe-negation"]